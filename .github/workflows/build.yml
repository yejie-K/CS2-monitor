name: Build Windows Exe

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest  # 这里指定了用 Windows 系统打包

    steps:
    - uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        # 直接安装所需库，不需要 requirements.txt 文件了，省事
        pip install pandas requests openpyxl xlsxwriter playwright pyinstaller xlrd
        playwright install chromium

    # 1. 打包 Buff 登录器
    - name: Build Buff Login
      run: |
        pyinstaller -F get_cookie_buff.py --name "1_Buff_Login" --clean

    # 2. 打包 UU 登录器
    - name: Build UU Login
      run: |
        pyinstaller -F get_cookie_uu.py --name "2_UU_Login" --clean

    # 3. 打包 主监控程序
    - name: Build Main Monitor
      run: |
        pyinstaller -F main_app.py --name "3_CS2_Monitor" --clean

    # 4. 上传打包好的文件
    - name: Upload Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: CS2_Tools_Windows
        path: dist/*.exe